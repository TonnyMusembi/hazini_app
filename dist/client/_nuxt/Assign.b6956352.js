import{_ as A}from"./Spin.c43bcd68.js";import{f as U,_ as j}from"./ThePermissionsByRole.vue.df119d48.js";import{i as G,f as N,s as x,r as l,H as W,o as t,b as i,h as e,y as B,K as H,u as r,A as I,x as L,c as g,t as k,I as Q,F as C,B as J,W as K,a as X}from"./entry.d9247041.js";import{a as w,u as Y}from"./login.c95085de.js";import{u as O}from"./AddResourcesDialog.vue.fe5c3e02.js";import"./DialogTitle.3caea66f.js";import"./DialogComponent.vue.4a7fb94b.js";import"./use-event-listener.8ae17784.js";import"./update-role.47af15ac.js";import"./use-resolve-button-type.8f768677.js";const q=G("assign-role-store",{state:()=>({pending:!1,error:{hasError:!1,message:"",field:""},responseOK:!1}),actions:{async assignRole(_,n){try{this.pending=!0;let s={hasError:!1,message:"",field:""};this.error=s;let c=!1;this.responseOK=c;const{data:R}=await w("/api/users/assign-role",{method:"put",body:{body:_,accessToken:n},async onResponse({request:u,response:o,options:y}){o.ok&&(c=!0)},async onResponseError({request:u,response:o,options:y}){o.status==400&&(s={hasError:!0,message:"role_id  or user_id is invalid",field:"none"}),o.status==401&&(s={hasError:!0,message:"you are not authorised to perform that action",field:"none"}),o.status===404&&(s={hasError:!0,message:"Role or user not found",field:"name"}),o.status===500&&(s={hasError:!0,message:"Internal server error",field:"none"})}},"$SwGdW3BmQ0");this.pending=!1,this.error=s,this.responseOK=c}catch{this.pending=!1}},unsetError(){this.error={hasError:!1,message:"",field:""}}}}),Z=["onSubmit"],ee=e("label",{for:"default-search",class:"mb-2 text-sm font-medium text-gray-900 sr-only"},"Search",-1),se={class:"relative"},te=e("div",{class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},[e("svg",{"aria-hidden":"true",class:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1),oe=e("button",{type:"submit",class:"text-white absolute right-2.5 bottom-2.5 bg-teal-700 hover:bg-teal-800 focus:ring-4 focus:outline-none focus:ring-teal-300 font-medium rounded-lg text-sm px-2 py-1"}," Search ",-1),re={key:0},ne={key:1,class:"shadow-sm rounded-md w-full columns-2 bg-gray-200 p-4"},ae={class:"mb-3 w-full"},le=e("label",{for:"name",class:"block text-sm font-semibold leading-6 text-gray-900"},"Select Role to assign",-1),ie=["value"],ce={class:"h-[25rem] overflow-scroll"},ue={class:"flex justify-end py-3"},de={key:1},fe=N({__name:"AssignRole",async setup(_){let n,s;const{setSelectedRole:c}=O(),{assignRole:R}=q(),{user:u}=x(Y()),{selectedRole:o}=x(O()),{pending:y,error:he,responseOK:ge}=x(q()),p=l(""),v=l(!1);l(null);const d=l(),T=async()=>{v.value=!0;const{data:h,pending:f,error:S,refresh:E}=await w("/api/roles/get-role-by-phone",{query:{phone:p.value,accessToken:u.value.refresh_token}},"$Ia5h5OeFnr");v.value=!1,d.value=h.value},$=l(10),D=l(1),{data:b,pending:_e,error:ye,refresh:F}=([n,s]=W(()=>w("/api/roles/list",{query:{accessToken:u.value.refresh_token,pageID:D.value,pageSize:$.value}},"$9G7s94l2e1")),n=await n,s(),n);F();const M=()=>b.value!=null&&b.value?U(b.value):[],m=l(),V=()=>{c(m.value)},z=()=>{const h={role_id:o.value.id,user_id:d.value.id};R(h,u.value.refresh_token)};return(h,f)=>{const S=A,E=j,P=A;return t(),i(C,null,[e("form",{onSubmit:L(T,["prevent"]),class:"mb-3 w-full"},[ee,e("div",se,[te,B(e("input",{type:"search",id:"default-search","onUpdate:modelValue":f[0]||(f[0]=a=>I(p)?p.value=a:null),class:"block w-full p-3 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:outline-teal-700 focus:ring-teal-500 focus:border-0",placeholder:"Enter phone number and hit enter...",required:""},null,512),[[H,r(p)]]),oe])],40,Z),r(d)?(t(),i("div",re,[r(v)?(t(),g(S,{key:0,class:"text-teal-700"})):(t(),i("div",ne,[e("div",null,k(r(d).full_names),1),e("div",null,k(r(d).phone_number),1)])),e("form",ae,[le,B(e("select",{"onUpdate:modelValue":f[1]||(f[1]=a=>I(m)?m.value=a:null),onChange:V,class:"block appearance-none w-full bg-gray-200 border border-gray-200 text-gray-700 py-3 px-4 pr-8 rounded leading-tight focus:outline-none focus:bg-white focus:border-gray-500"},[(t(!0),i(C,null,J(M(),a=>(t(),i("option",{value:a,key:a.id},k(a.name),9,ie))),128))],544),[[Q,r(m)]])]),e("div",ce,[r(o)!=null?(t(),g(E,{key:0})):K("",!0)]),e("div",ue,[e("button",{onClick:z,type:"submit",class:"rounded-lg text-sm font-semibold py-2.5 px-4 text-sky-50 bg-teal-700 hover:text-sky-50/80 hover:bg-teal-600"},[r(y)?(t(),g(P,{key:0})):(t(),i("span",de,"Assign Role"))])])])):K("",!0)],64)}}}),pe={};function me(_,n){const s=fe;return t(),g(s)}const Ie=X(pe,[["render",me]]);export{Ie as default};
