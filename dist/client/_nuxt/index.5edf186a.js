import{_ as j}from"./Spin.c43bcd68.js";import{_ as P,a as G}from"./DialogTitle.3caea66f.js";import{i as J,f as B,r as y,s as C,o as c,b as f,h as e,t as r,u as d,c as I,D as F,C as p,E as Q,H as W,x as X,y as Z,K as ee,A as se,F as A,B as te,J as oe,W as N,L as ae,a as ne,G as le}from"./entry.d9247041.js";import{a as K,u as L}from"./login.c95085de.js";import{u as O}from"./user.14e2b21b.js";import{u as T,m as re,_ as ce,a as ie}from"./DialogComponent.vue.4a7fb94b.js";import{E as _e}from"./index.ca1547d3.js";import{_ as de}from"./PlusButton.fa1895e9.js";import"./use-event-listener.8ae17784.js";const E=J("disable-user-store",{state:()=>({pending:!1,responseOK:!1,nonFieldErrors:"",fieldErrors:null,actionIsToDisable:!1,refreshFunction:null}),actions:{async disableUser(u,n,i){console.log(n);try{this.pending=!0;let o="",_=null,h=!1;this.responseOK=h;const{data:b}=await K("/api/users/disable",{method:"put",body:{accessToken:u,status:n,userID:i},async onResponse({request:m,response:t,options:x}){t.ok&&(h=!0)},async onResponseError({request:m,response:t,options:x}){var g,v,l;t.status==400&&(_=(g=t._data)==null?void 0:g.data.errors),t.status==401&&(o="Unauthorised"),t.status===403&&(o=(v=t._data)==null?void 0:v.data.error),t.status===404&&(o=(l=t._data)==null?void 0:l.data.error),t.status===500&&(o="Internal Error")}},"$XFskEaHEQm");this.pending=!1,this.fieldErrors=_,this.nonFieldErrors=o,this.responseOK=h}catch{this.pending=!1}},setDisableAction(u){this.actionIsToDisable=u},setRefreshFunction(u){this.refreshFunction=u}}}),pe={class:"mx-auto"},ue=e("p",{class:"flex justify-center items-center"},"Are you sure!",-1),he={class:"text-red-500 mb-6 text-sm"},fe={class:"flex justify-end"},me={key:1},xe=B({__name:"DisableUser",setup(u){y();const{disableUser:n,refreshFunction:i}=E(),{closeDisableUserDialog:o}=T(),{actionIsToDisable:_}=C(E()),{pending:h,nonFieldErrors:b,fieldErrors:m,responseOK:t}=C(E()),{user:x}=C(L()),{selectedUser:g}=C(O()),v=y(g.value),l=async()=>{const $=x.value.refresh_token;console.log(_.value);let w;_.value?w=0:w=1,console.log(w),await n($,w,v.value.id),t.value&&(o(),i())};return($,w)=>{const S=j;return c(),f("div",pe,[ue,e("p",he,r(d(m)),1),e("div",fe,[e("button",{onClick:l,class:"inline-flex rounded-lg text-sm font-semibold py-2.5 px-4 text-sky-50 bg-teal-700 hover:text-sky-50/80 hover:bg-teal-600"},[d(h)?(c(),I(S,{key:0})):(c(),f("span",me,"Confirm"))])])])}}}),ye={class:"w-full p-4 space-y-3"},be=e("p",{class:"text-sm text-gray-600"},null,-1),ge=B({__name:"DisableUserDialog",props:{refreshUsers:{type:Function,required:!0}},setup(u){const{showDisableUserDialog:n}=C(T()),{closeDisableUserDialog:i}=T();return(o,_)=>{const h=P,b=G,m=xe,t=ce,x=ie;return c(),I(d(re),{as:"template",show:d(n)},{default:F(()=>[p(x,{closeFunc:d(i)},{default:F(()=>[p(h,null,{default:F(()=>[Q("Update Status")]),_:1}),p(b),e("div",ye,[p(m)]),p(t,null,{default:F(()=>[be]),_:1})]),_:1},8,["closeFunc"])]),_:1},8,["show"])}}}),ve=e("div",{class:"flex justify-start"}," Users ",-1),we={class:"flex justify-end"},De=["onSubmit"],ke=e("label",{for:"default-search",class:"mb-2 text-sm font-medium text-gray-900 sr-only"},"Search",-1),Ue={class:"relative"},Ce=e("div",{class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},[e("svg",{"aria-hidden":"true",class:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1),Se=e("button",{type:"submit",class:"text-white absolute right-2.5 bottom-2.5 bg-teal-700 hover:bg-teal-800 focus:ring-4 focus:outline-none focus:ring-teal-300 font-medium rounded-lg text-sm px-2 py-1"}," Search ",-1),Fe=e("br",null,null,-1),$e={key:1,class:"shadow overflow-scroll border-b border-gray-200 sm:rounded-lg"},Ee={class:"overflow-auto h-[35rem] relative shadow-md sm:rounded-lg"},Te={class:"w-full text-sm text-left text-gray-500"},Ae=e("thead",{class:"text-xs text-gray-700 bg-gray-200"},[e("tr",{class:"divide-x divide-gray-300"},[e("th",{scope:"col",class:"py-3 px-6"}),e("th",{scope:"col",class:"py-3 px-6"},"User name"),e("th",{scope:"col",class:"py-3 px-6"},"Phone Number"),e("th",{scope:"col",class:"py-3 px-6"},"ID number"),e("th",{scope:"col",class:"py-3 px-6"},"Salary"),e("th",{scope:"col",class:"py-3 px-6"},"Loan"),e("th",{scope:"col",class:"py-3 px-6"},"Balance"),e("th",{scope:"col",class:"py-3 px-6"},"Company"),e("th",{scope:"col",class:"py-3 px-6"},"Branch"),e("th",{scope:"col",class:"py-3 px-6"},"Assignment"),e("th",{scope:"col",class:"py-3 px-6"},"Status"),e("th",{scope:"col",class:"py-3 px-6"},"Created at"),e("th",{scope:"col",class:"py-3 px-6"},"Enable/Disable"),e("th",{scope:"col",class:"py-3 px-6"},"Details")])],-1),Be={scope:"row",class:"py-4 px-6 font-medium text-gray-900 whitespace-nowrap"},Ie={class:"py-4 px-6"},Me={class:"py-4 px-6"},Ne={class:"py-4 px-6"},je={class:"py-4 px-6"},Ke={class:"py-4 px-6"},Le={class:"py-4 px-6"},Oe={class:"py-4 px-6"},Re={class:"py-4 px-6"},Ve={class:"py-4 px-6"},qe={class:"py-4 px-6 text-sm"},ze={key:0},Ye={key:1},He={class:"py-4 px-6"},Pe=["onClick"],Ge={class:"inline-flex relative items-center mr-5 cursor-pointer"},Je=["checked"],Qe=e("div",{class:"w-11 h-6 bg-gray-200 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-teal-600"},null,-1),We=["onClick"],Xe=B({__name:"TheUsers",async setup(u){let n,i;y("MM/DD/YYYY");const o=y(),{user:_}=C(L()),{openDisableUserDialog:h}=T(),{setDisableAction:b,setRefreshFunction:m}=E(),{setSelectedUser:t}=O(),x=y(),g=y(10),v=y(1),{data:l,pending:$,error:w,refresh:S}=([n,i]=W(()=>K("/api/users/list",{query:{pageSize:g.value,pageID:v.value,accessToken:_.value.refresh_token}},"$pceMPOiS8C")),n=await n,i(),n);S();const R=a=>{t(a),m(S),a.user_status==1?b(!0):a.user_status==0&&b(!1),h()};function V(a){var D=new Date(a),k=""+(D.getMonth()+1),U=""+D.getDate(),s=D.getFullYear();return k.length<2&&(k="0"+k),U.length<2&&(U="0"+U),[U,k,s].join("-")}const q=a=>{if(a===1)return!0;if(a===0)return!1},z=a=>{console.log(a.value),t(a),ae("/detail")},Y=()=>{if(l){if(l.value)l.value=l.value.filter(a=>a.username.toLowerCase().includes(o.value.toLowerCase()));else return l.value;console.log(x),console.log(l.value)}};return(a,D)=>{const k=j,U=ge;return c(),f(A,null,[ve,e("div",we,[e("form",{class:"mb-3 w-1/3",onSubmit:X(Y,["prevent"])},[ke,e("div",Ue,[Ce,Z(e("input",{type:"search",id:"default-search",class:"block w-full p-3 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:outline-teal-700 focus:ring-teal-500 focus:border-0",placeholder:"Search users...","onUpdate:modelValue":D[0]||(D[0]=s=>se(o)?o.value=s:null),required:""},null,512),[[ee,d(o)]]),Se])],40,De)]),Fe,d($)?(c(),I(k,{key:0,class:"h-20 w-20 text-teal-700"})):(c(),f("div",$e,[e("div",Ee,[e("table",Te,[Ae,e("tbody",null,[(c(!0),f(A,null,te(d(l),(s,M)=>(c(),f("tr",{key:s.phone_number,class:oe([{"bg-gray-50":M%2===1},"bg-white border-b divide-x hover:bg-teal-100 cursor-pointer"])},[e("th",Be,r(M+1),1),e("td",Ie,r(s.full_names),1),e("td",Me,r(s.phone_number),1),e("td",Ne,r(s.national_id_number.String),1),e("td",je,r(s.net_salary),1),e("td",Ke,r(s.loan_amount),1),e("td",Le,r(s.balance),1),e("td",Oe,r(s.company_name),1),e("td",Re,r(s.branch_name),1),e("td",Ve,r(s.assignment),1),e("td",qe,[s.user_status===0?(c(),f("label",ze," Not Active ")):N("",!0),s.user_status===1?(c(),f("label",Ye," Active ")):N("",!0)]),e("td",He,r(V(s.created_at)),1),e("td",{class:"py-4 px-6",onClick:H=>R(s)},[e("label",Ge,[e("input",{type:"checkbox",value:"",class:"sr-only peer",checked:q(s.user_status)},null,8,Je),Qe])],8,Pe),e("td",{class:"py-4 px-6 cursor-pointer",onClick:H=>z(s)},[p(d(_e),{class:"text-teal-700 h-6 w-6"})],8,We)],2))),128))])])])])),p(U,{"refresh-users":d(S)},null,8,["refresh-users"])],64)}}}),Ze={};function es(u,n){const i=Xe,o=de,_=le;return c(),f(A,null,[p(i),p(_,{to:"/users/addbulk"},{default:F(()=>[p(o)]),_:1})],64)}const _s=ne(Ze,[["render",es]]);export{_s as default};
